<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Targeted Variable Importance for Differential Methylation Analysis • methyvim</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="jquery.sticky-kit.min.js"></script><script src="pkgdown.js"></script><meta property="og:title" content="Targeted Variable Importance for Differential Methylation Analysis">
<meta property="og:description" content="This package provides facilities for differential methylation
  analysis based on variable importance measures (VIMs), a class of statistical
  target parameters that arise in causal inference. The estimation and inference
  procedures provided are nonparametric, relying on ensemble machine learning to
  flexibly assess functional relationships among covariates and the outcome of
  interest. These tools can be applied to differential methylation at the level
  of CpG sites, to obtain valid statistical inference even after corrections for
  multiple hypothesis testing.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">methyvim</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/using_methyvim.html">Targeted Data-Adaptive Estimation and Inference for Differential Methylation Analysis</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/nhejazi/methyvim">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    

    
    
<div class="contents">
<!-- README.md is generated from README.Rmd. Please edit that file -->
<div id="rmethyvim" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#rmethyvim" class="anchor"></a>R/<code>methyvim</code>
</h1></div>

<blockquote>
<p>Targeted Data-Adaptive Estimation and Inference for Differential Methylation Analysis</p>
</blockquote>
<p><strong>Author:</strong> <a href="https://nimahejazi.org">Nima Hejazi</a></p>
<hr>
<div id="whats-methyvim" class="section level2">
<h2 class="hasAnchor">
<a href="#whats-methyvim" class="anchor"></a>What’s <code>methyvim</code>?</h2>
<p><code>methyvim</code> is an R package that provides facilities for differential methylation analysis based on <em>variable importance measures</em> (VIMs), a class of statistically estimable target parameters that arise in causal inference.</p>
<p>The statistical methodology implemented computes targeted minimum loss-based estimates of several well-characterized variable importance measures:</p>
<p>For discrete-valued treatments or exposures:</p>
<ul>
<li><p>The <em>average treatment effect</em> (ATE): The effect of a binary exposure or treatment on the observed methylation at a target CpG site is estimated, controlling for the observed methylation at all other CpG sites in the same neighborhood as the target site, based on an additive form. In particular, the parameter estimate represents the <strong>additive difference</strong> in methylation that would have been observed at the target site had all observations received the treatment versus the scenario in which none received the treatment.</p></li>
<li><p>The <em>relative risk</em> (RR): The effect of a binary exposure or treatment on the observed methylation at a target CpG site is estimated, controlling for the observed methylation at all other CpG sites in the same neighborhood as the target site, based on an geometric form. In particular, the parameter estimate represents the <strong>multiplicative difference</strong> in methylation that would have been observed at the target site had all observations received the treatment versus the scenario in which none received the treatment.</p></li>
</ul>
<p>For continous-valued treatments or exposures:</p>
<ul>
<li>A <em>nonparametric variable importance measure</em> (NPVI) <span class="citation">(Chambaz, Neuvial, and van der Laan 2012)</span>: The effect of continous-valued exposure or treatment (the observed methylation at a target CpG site) on an outcome of interest is estimated, controlling for the observed methylation at all other CpG sites in the same neighborhood as the target (treatment) site, based on a parameter that compares values of the treatment against a reference value taken to be the null. In particular, the implementation provided is designed to assess the effect of differential methylation at the target CpG site on a (typically) phenotype-level outcome of interest (e.g., survival), in effect providing an nonparametric evaluation of the impact of methylation at the target site on said outcome.</li>
</ul>
<p><em>In all cases, an estimator of the target parameter is constructed via targeted minimum loss-based estimation.</em></p>
<p>These methods allow differential methylation effects to be quantified in a manner that is largely free of assumptions, especially of the variety exploited in parametric models. <strong>The statistical algorithm consists in several major steps:</strong></p>
<ol style="list-style-type: decimal">
<li>Pre-screening of genomic sites is used to isolate a subset of sites for which there is cursory evidence of differential methylation. For the sake of computational feasibility, targeted minimum loss-based estimates of VIMs are computed only for this subset of sites. Several screening approaches are available, adapting core routines from the following R packages: <a href="http://bioconductor.org/packages/release/bioc/html/limma.html"><code>limma</code></a>, <a href="https://CRAN.R-project.org/package=tmle.npvi"><code>tmle.npvi</code></a>.</li>
<li>Nonparametric VIMs are estimated for the specified parameter, currently adapting routines from the <a href="https://CRAN.R-project.org/package=tmle.npvi"><code>tmle.npvi</code></a> and <a href="https://CRAN.R-project.org/package=tmle"><code>tmle</code></a> R packages.</li>
<li>Since pre-screening is performed prior to estimating VIMs, we make use of a multiple testing correction uniquely suited to such settings. Due to the multiple testing nature of the estimation problem, a variant of the Benjamini &amp; Hochberg procedure for controlling the False Discovery Rate (FDR) is applied <span class="citation">(Benjamini and Hochberg 1995)</span>. Specifically, we apply the modified marginal Benjamini &amp; Hochberg step-up False Discovery Rate controlling procedure for multi-stage analyses (FDR-MSA) <span class="citation">(Tuglus and van der Laan 2009)</span>.</li>
</ol>
<p>For a general discussion of the framework of targeted minimum loss-based estimation, the many applications of this methodology, and the role the framework plays in statistical causal inference, the recommended references are <span class="citation">van der Laan and Rose (2011)</span> and <span class="citation">van der Laan and Rose (2017)</span>. <span class="citation">Hernan and Robins (2018)</span> and <span class="citation">Pearl (2009)</span> may be of interest to those desiring a more general introduction to statistical causal inference.</p>
<hr>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>For standard use, install from <a href="https://bioconductor.org/packages/methyvim">Bioconductor</a>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">source</span>(<span class="st">"https://bioconductor.org/biocLite.R"</span>)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">biocLite</span>(<span class="st">"methyvim"</span>)</a></code></pre></div>
<p>To contribute, install the bleeding-edge <em>development version</em> from GitHub via <a href="https://www.rstudio.com/products/rpackages/devtools/"><code>devtools</code></a>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">devtools<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/devtools/topics/install_github">install_github</a></span>(<span class="st">"nhejazi/methyvim"</span>)</a></code></pre></div>
<p>Current and prior <a href="https://bioconductor.org">Bioconductor</a> releases are available under branches with numbers prefixed by “RELEASE_”. For example, to install the version of this package available via Bioconductor 3.6, use</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">devtools<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/devtools/topics/install_github">install_github</a></span>(<span class="st">"nhejazi/methyvim"</span>, <span class="dt">ref =</span> <span class="st">"RELEASE_3_6"</span>)</a></code></pre></div>
<hr>
</div>
<div id="example" class="section level2">
<h2 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h2>
<p>For details on how to best use the <code>methyvim</code> R package, please consult the most recent <a href="http://bioconductor.org/packages/release/bioc/vignettes/methyvim/inst/doc/using_methyvim.html">package vignette</a> available through the <a href="https://bioconductor.org/packages/methvim">Bioconductor Project</a>.</p>
<hr>
</div>
<div id="issues" class="section level2">
<h2 class="hasAnchor">
<a href="#issues" class="anchor"></a>Issues</h2>
<p>If you encounter any bugs or have any specific feature requests, please <a href="https://github.com/nhejazi/methyvim/issues">file an issue</a>.</p>
<hr>
</div>
<div id="contributions" class="section level2">
<h2 class="hasAnchor">
<a href="#contributions" class="anchor"></a>Contributions</h2>
<p>Contributions are very welcome. Interested contributors should consult our <a href="https://github.com/nhejazi/methyvim/blob/master/CONTRIBUTING.md">contribution guidelines</a> prior to submitting a pull request.</p>
<hr>
</div>
<div id="citation" class="section level2">
<h2 class="hasAnchor">
<a href="#citation" class="anchor"></a>Citation</h2>
<p>After using the <code>methyvim</code> R package, please cite the following:</p>
<pre><code>    @article{hejazi2018methyvim,
      doi = {},
      url = {},
      year  = {2018},
      month = {},
      publisher = {},
      volume = {},
      author = {Hejazi, Nima S and Phillips, Rachael V and Hubbard, Alan E
        and {van der Laan}, Mark J},
      title = {methyvim: Targeted and model-free differential methylation
        analysis in R},
      journal = {}
    }</code></pre>
<hr>
</div>
<div id="related" class="section level2">
<h2 class="hasAnchor">
<a href="#related" class="anchor"></a>Related</h2>
<ul>
<li>
<a href="https://github.com/nhejazi/methyvimData">R/<code>methyvimData</code></a> - R package with sample experimental DNA methylation data for use as an example with this analysis package.</li>
</ul>
<hr>
</div>
<div id="funding" class="section level2">
<h2 class="hasAnchor">
<a href="#funding" class="anchor"></a>Funding</h2>
<p>The development of this software was supported in part through grants from the National Institutes of Health: <a href="https://projectreporter.nih.gov/project_info_description.cfm?aid=9248418&amp;icde=37849831&amp;ddparam=&amp;ddvalue=&amp;ddsub=&amp;cr=1&amp;csb=default&amp;cs=ASC&amp;pball=">T32 LM012417-02</a>, <a href="https://projectreporter.nih.gov/project_info_description.cfm?aid=9210551&amp;icde=37849782&amp;ddparam=&amp;ddvalue=&amp;ddsub=&amp;cr=1&amp;csb=default&amp;cs=ASC&amp;pball=">R01 ES021369-05</a>, and <a href="https://projectreporter.nih.gov/project_info_details.cfm?aid=9260357&amp;map=y">P42 ES004705-29</a>.</p>
<hr>
</div>
<div id="license" class="section level2">
<h2 class="hasAnchor">
<a href="#license" class="anchor"></a>License</h2>
<p>© 2017-2018 <a href="https://nimahejazi.org">Nima S. Hejazi</a></p>
<p>The contents of this repository are distributed under the MIT license. See file <code>LICENSE</code> for details.</p>
<hr>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references">
<div id="ref-benjamini1995controlling">
<p>Benjamini, Yoav, and Yosef Hochberg. 1995. “Controlling the False Discovery Rate: A Practical and Powerful Approach to Multiple Testing.” <em>Journal of the Royal Statistical Society. Series B (Methodological)</em>. JSTOR, 289–300.</p>
</div>
<div id="ref-chambaz2012estimation">
<p>Chambaz, Antoine, Pierre Neuvial, and Mark J van der Laan. 2012. “Estimation of a Non-Parametric Variable Importance Measure of a Continuous Exposure.” <em>Electronic Journal of Statistics</em> 6. NIH Public Access:1059.</p>
</div>
<div id="ref-hernan2018causal">
<p>Hernan, Miguel A, and James M Robins. 2018. <em>Causal Inference</em>. Chapman &amp; Hall / CRC Texts in Statistical Science. Taylor &amp; Francis.</p>
</div>
<div id="ref-pearl2009causality">
<p>Pearl, Judea. 2009. <em>Causality: Models, Reasoning, and Inference</em>. Cambridge University Press.</p>
</div>
<div id="ref-tuglus2009modified">
<p>Tuglus, Catherine, and Mark J van der Laan. 2009. “Modified FDR Controlling Procedure for Multi-Stage Analyses.” <em>Statistical Applications in Genetics and Molecular Biology</em> 8 (1). Walter de Gruyter:1–15. <a href="https://doi.org/10.2202/1544-6115.1397" class="uri">https://doi.org/10.2202/1544-6115.1397</a>.</p>
</div>
<div id="ref-vdl2011targeted">
<p>van der Laan, Mark J, and Sherri Rose. 2011. <em>Targeted Learning: Causal Inference for Observational and Experimental Data</em>. Springer Science &amp; Business Media.</p>
</div>
<div id="ref-vdl2017targeted">
<p>———. 2017. <em>Targeted Learning in Data Science: Causal Inference for Complex Longitudinal Studies</em>. Springer Science &amp; Business Media.</p>
</div>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2 class="hasAnchor">
<a href="#sidebar" class="anchor"></a>Links</h2>
<ul class="list-unstyled">
<li>Download from BIOC at <br><a href="https://www.bioconductor.org/packages/methyvim">https://​www.bioconductor.org/​packages/​methyvim</a>
</li>
<li>Browse source code at <br><a href="https://github.com/nhejazi/methyvim">https://​github.com/​nhejazi/​methyvim</a>
</li>
<li>Report a bug at <br><a href="https://github.com/nhejazi/methyvim/issues">https://​github.com/​nhejazi/​methyvim/​issues</a>
</li>
</ul>
<h2>License</h2>
<p>file <a href="LICENSE.html">LICENSE</a></p>
<h2>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html">Citing methyvim</a></li>
</ul>
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Nima Hejazi <br><small class="roles"> Author, maintainer, copyright holder </small> <a href="https://orcid.org/0000-0002-7127-2789" target="orcid.widget"><img src="https://members.orcid.org/sites/default/files/vector_iD_icon.svg" class="orcid"></a> </li>
<li>Mark van der Laan <br><small class="roles"> Author, thesis advisor </small>  </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.org/nhejazi/methyvim"><img src="https://travis-ci.org/nhejazi/methyvim.svg?branch=master" alt="Travis-CI Build Status"></a></li>
<li><a href="https://ci.appveyor.com/project/nhejazi/methyvim"><img src="https://ci.appveyor.com/api/projects/status/github/nhejazi/methyvim?branch=master&amp;svg=true" alt="AppVeyor Build Status"></a></li>
<li><a href="https://codecov.io/github/nhejazi/methyvim?branch=master"><img src="https://img.shields.io/codecov/c/github/nhejazi/methyvim/master.svg" alt="Coverage Status"></a></li>
<li><a href="http://www.repostatus.org/#active"><img src="http://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active – The project has reached a stable, usable state and is being actively developed."></a></li>
<li><a href="http://opensource.org/licenses/MIT"><img src="http://img.shields.io/badge/license-MIT-brightgreen.svg" alt="MIT license"></a></li>
<li><a href="https://zenodo.org/badge/latestdoi/79256902"><img src="https://zenodo.org/badge/79256902.svg" alt="DOI"></a></li>
</ul>
</div>

</div>


      <footer><div class="copyright">
  <p>Developed by Nima Hejazi, Mark van der Laan.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
